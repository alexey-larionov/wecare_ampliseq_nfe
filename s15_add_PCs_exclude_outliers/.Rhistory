rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
# Make logical vector of new 46 outliers
pc_outliers_new <- phenotypes.df$long_ids %in% manual_outliers.df$sample
sum(pc_outliers_new)
sum(pc_outliers_new == phenotypes.df$pc_outlier)
sum(pc_outliers_new & phenotypes.df$pc_outlier)
sum(pc_outliers_new & !phenotypes.df$pc_outlier)
sum(!pc_outliers_new & phenotypes.df$pc_outlier)
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
# Make logical vector of new 46 outliers
ev_outliers <- phenotypes.df$long_ids %in% manual_outliers.df$sample
sum(ev_outliers)
# Add vector to the phenotypes table
phenotypes.df <- data.frame(phenotypes.df, ev_outliers)
# Exclude outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$ev_outliers,]
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
dim(manual_outliers.df)
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
dim(manual_outliers.df)
# Make logical vector of new 46 outliers
ev_outliers <- phenotypes.df$long_ids %in% manual_outliers.df$sample
sum(ev_outliers)
# Add vector to the phenotypes table
phenotypes.df <- data.frame(phenotypes.df, ev_outliers)
# Exclude outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$ev_outliers,]
# Remove unnecessary columns
phenotypes.df <- phenotypes.df %>%
select(-ev_outliers,-pc_outlier,-pc1_outlier,-pc2_outlier,-pc3_outlier,-pc4_outlier,-pc5_outlier)
# Check result
dim(phenotypes.df)
View(phenotypes.df)
View(genotypes.mx)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,phenotypes.df$long_ids]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
genotypes[1:5,1:5]
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
# Clean up
rm(manual_outliers.df, ev_outliers)
brca_palb_carriers <- c(48,311,317,377,137,140)
brca_palb_carriers %in% phenotypes.df$sample_id
brca_palb_carriers[brca_palb_carriers %in% phenotypes.df$sample_id]
phenotypes.df[retained_carriers,sample_id]
brca_palb_carriers <- c(48,311,317,377,137,140)
retained_carriers <- phenotypes.df$sample_id %in% brca_palb_carriers
phenotypes.df[retained_carriers,sample_id]
phenotypes.df[retained_carriers,"sample_id"]
phenotypes.df <- phenotypes.df[!retained_carriers,]
phenotypes.df <- phenotypes.df[!retained_carriers,]
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
dim(manual_outliers.df)
# Chunk 5: remove_outliers
# Make logical vector of new 46 outliers
ev_outliers <- phenotypes.df$long_ids %in% manual_outliers.df$sample
sum(ev_outliers)
# Add vector to the phenotypes table
phenotypes.df <- data.frame(phenotypes.df, ev_outliers)
# Exclude outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$ev_outliers,]
# Remove unnecessary columns
phenotypes.df <- phenotypes.df %>%
select(-ev_outliers,-pc_outlier,-pc1_outlier,-pc2_outlier,-pc3_outlier,-pc4_outlier,-pc5_outlier)
# Clean up
rm(manual_outliers.df, ev_outliers)
brca_palb_carriers <- c(48,311,317,377,137,140)
retained_carriers <- phenotypes.df$sample_id %in% brca_palb_carriers
phenotypes.df[retained_carriers,"sample_id"]
phenotypes.df <- phenotypes.df[!retained_carriers,]
rm(brca_palb_carriers, retained_carriers)
genotypes.mx <- genotypes.mx[,phenotypes.df$long_ids]
dim(genotypes.mx)
genotypes.mx[1:5,1:5]
dim(phenotypes.df)
phenotypes.df[1:5,1:5]
?all
x <- c(1,2,3)
length(unique(x))
x <- c(1,2,NA)
length(unique(x))
?unique
length(unique(x, incomparables=NA))
x
length(unique(x, incomparables=c(NA)))
uniform.udf <- function(x){min(x,na.rm=T)==max(x,na.rm=T)}
uniform.udf(x)
x <- c(1,1,NA)
uniform.udf(x)
x <- c(NA,NA,NA)
uniform.udf(x)
?isTRUE
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE)
min(x,na.rm=T)==max(x,na.rm=T)}
uniform.udf(x)
x
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
sum(rownames(genotypes.mx) != rownames(phenotypes.df))
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
dim(manual_outliers.df)
sum(rownames(genotypes.mx) != rownames(phenotypes.df))
dim(genotypes.mx)
dim(phenotypes.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(colnames(genotypes.mx) != phenotypes.df$long_ids
sum(colnames(genotypes.mx) != phenotypes.df$long_ids)
rownames(phenotypes.df) <- phenotypes.df$long_ids
sum(rownames(genotypes.mx) != rownames(variants.df))
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
variants.df[1:5,1:5]
manual_outliers.df[1:5,]
sum(colnames(genotypes.mx) != phenotypes.df$long_ids)
rownames(phenotypes.df) <- phenotypes.df$long_ids
sum(rownames(genotypes.mx) != rownames(variants.df))
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
dim(manual_outliers.df)
sum(colnames(genotypes.mx) != phenotypes.df$long_ids)
rownames(phenotypes.df) <- phenotypes.df$long_ids
sum(rownames(genotypes.mx) != rownames(variants.df))
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
variants.df[1:5,1:5]
manual_outliers.df[1:5,]
# Chunk 5: remove_outliers
# Make logical vector of new 46 outliers
ev_outliers <- phenotypes.df$long_ids %in% manual_outliers.df$sample
sum(ev_outliers)
# Add vector to the phenotypes table
phenotypes.df <- data.frame(phenotypes.df, ev_outliers)
# Exclude outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$ev_outliers,]
# Remove unnecessary columns
phenotypes.df <- phenotypes.df %>%
select(-ev_outliers,-pc_outlier,-pc1_outlier,-pc2_outlier,-pc3_outlier,-pc4_outlier,-pc5_outlier)
# Clean up
rm(manual_outliers.df, ev_outliers)
# Chunk 6: remove_carriers
brca_palb_carriers <- c(48,311,317,377,137,140)
retained_carriers <- phenotypes.df$sample_id %in% brca_palb_carriers
phenotypes.df[retained_carriers,"sample_id"]
phenotypes.df <- phenotypes.df[!retained_carriers,]
rm(brca_palb_carriers, retained_carriers)
genotypes.mx <- genotypes.mx[,phenotypes.df$long_ids]
dim(genotypes.mx)
genotypes.mx[1:5,1:5]
dim(phenotypes.df)
phenotypes.df[1:5,1:5]
# Function to detect uniform vectors (expects vectors containing 0,1,2 or NA only)
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
View(genotypes.mx)
View(phenotypes.df)
View(variants.df)
genotypes.mx <- genotypes.mx[!uniform_variants,]
variants.df <- variants.df[!uniform_variants,]
colnames(variants.df)
dim(genotypes.mx)
dim(variants.df)
unique(variants.df$CHROM)
rm(uniform_variants)
rm(uniform_variants, uniform.udf)
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
sum(c(NA,NA,NA))
sum(c(NA,NA,NA), na.rm=T)
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
an.udf <- function(x){sum(!is.na(x))}
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
hist(total_AF)
an.udf <- function(x){2*sum(!is.na(x))}
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
hist(total_AF)
summary(as.factor(phenotypes.df$group))
nfe_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="NFE"]
dim(nfe_genotypes.mx)
nfe_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="NFE"]
dim(nfe_genotypes.mx)
nfe_AC <- apply(nfe_genotypes.mx, 1, sum, na.rm=T)
nfe_AN <- apply(nfe_genotypes.mx, 1, an.udf)
nfe_AF <- nfe_AC/nfe_AN
hist(nfe_AF)
hist(nfe_AF, lab=T)
hist(nfe_AF, lab=T, ylim=c(0.1400))
hist(nfe_AF, lab=T, ylim=c(0.1400))
hist(nfe_AF, lab=T, ylim=c(0,1400))
hist(nfe_AF, lab=T, ylim=c(0,1500))
hist(total_AF, lab=T, ylim=c(0,1500))
ubc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="UBC"]
dim(ubc_genotypes.mx)
ubc_AC <- apply(ubc_genotypes.mx, 1, sum, na.rm=T)
ubc_AN <- apply(ubc_genotypes.mx, 1, an.udf)
ubc_AF <- ubc_AC/ubc_AN
hist(ubc_AF, lab=T, ylim=c(0,1500))
rm(nfe_genotypes.mx)
cbc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="CBC"]
dim(cbc_genotypes.mx)
cbc_AC <- apply(cbc_genotypes.mx, 1, sum, na.rm=T)
cbc_AN <- apply(cbc_genotypes.mx, 1, an.udf)
cbc_AF <- cbc_AC/cbc_AN
hist(cbc_AF, lab=T, ylim=c(0,1500))
rm(cbc_genotypes.mx)
rm(cbc_genotypes.mx, an.udf)
variants.df <- data.frame(variants.df,
total_AC, total_AN, total_AF,
nfe_AC, nfe_AN, nfe_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
rm(total_AC, total_AN, total_AF,
nfe_AC, nfe_AN, nfe_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s15_add_PCs_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s04_explore_ethnicity_of_214_715_outliers.RData", sep="/"))
# Remove unnecessary data
rm(eigenphen_ampliseq_kgen.df, pc1_th, pc2_th)
# Read data with wecare-only PCa and previously selected 26 outliers (based on wecare only PCs: mean +/- 3sd)
load(paste(base_folder, "s03_add_PCs_214_715.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
dim(manual_outliers.df)
sum(colnames(genotypes.mx) != phenotypes.df$long_ids)
rownames(phenotypes.df) <- phenotypes.df$long_ids
sum(rownames(genotypes.mx) != rownames(variants.df))
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
variants.df[1:5,1:5]
manual_outliers.df[1:5,]
# Chunk 5: remove_outliers
# Make logical vector of new 46 outliers
ev_outliers <- phenotypes.df$long_ids %in% manual_outliers.df$sample
sum(ev_outliers)
# Add vector to the phenotypes table
phenotypes.df <- data.frame(phenotypes.df, ev_outliers)
# Exclude outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$ev_outliers,]
# Remove unnecessary columns
phenotypes.df <- phenotypes.df %>%
select(-ev_outliers,-pc_outlier,-pc1_outlier,-pc2_outlier,-pc3_outlier,-pc4_outlier,-pc5_outlier)
# Clean up
rm(manual_outliers.df, ev_outliers)
# Chunk 6: remove_carriers
brca_palb_carriers <- c(48,311,317,377,137,140)
retained_carriers <- phenotypes.df$sample_id %in% brca_palb_carriers
phenotypes.df[retained_carriers,"sample_id"]
phenotypes.df <- phenotypes.df[!retained_carriers,]
rm(brca_palb_carriers, retained_carriers)
# Chunk 7: sync_genotypes
genotypes.mx <- genotypes.mx[,phenotypes.df$long_ids]
dim(genotypes.mx)
genotypes.mx[1:5,1:5]
dim(phenotypes.df)
phenotypes.df[1:5,1:5]
# Chunk 8
# Function to detect uniform vectors (expects vectors containing 0,1,2 or NA only)
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
genotypes.mx <- genotypes.mx[!uniform_variants,]
variants.df <- variants.df[!uniform_variants,]
dim(genotypes.mx)
dim(variants.df)
rm(uniform_variants, uniform.udf)
# Chunk 9: an_and_counts
an.udf <- function(x){2*sum(!is.na(x))}
summary(as.factor(phenotypes.df$group))
# Chunk 10: total_acanaf
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
hist(total_AF, lab=T, ylim=c(0,1500))
# Chunk 11: nfe_acanaf
nfe_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="NFE"]
dim(nfe_genotypes.mx)
nfe_AC <- apply(nfe_genotypes.mx, 1, sum, na.rm=T)
nfe_AN <- apply(nfe_genotypes.mx, 1, an.udf)
nfe_AF <- nfe_AC/nfe_AN
hist(nfe_AF, lab=T, ylim=c(0,1500))
rm(nfe_genotypes.mx)
# Chunk 12: ubc_acanaf
ubc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="UBC"]
dim(ubc_genotypes.mx)
ubc_AC <- apply(ubc_genotypes.mx, 1, sum, na.rm=T)
ubc_AN <- apply(ubc_genotypes.mx, 1, an.udf)
ubc_AF <- ubc_AC/ubc_AN
hist(ubc_AF, lab=T, ylim=c(0,1500))
rm(ubc_genotypes.mx)
# Chunk 13: cbc_acanaf
cbc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="CBC"]
dim(cbc_genotypes.mx)
cbc_AC <- apply(cbc_genotypes.mx, 1, sum, na.rm=T)
cbc_AN <- apply(cbc_genotypes.mx, 1, an.udf)
cbc_AF <- cbc_AC/cbc_AN
hist(cbc_AF, lab=T, ylim=c(0,1500))
rm(cbc_genotypes.mx, an.udf)
# Chunk 14: update_variants
variants.df <- data.frame(variants.df,
total_AC, total_AN, total_AF,
nfe_AC, nfe_AN, nfe_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
rm(total_AC, total_AN, total_AF,
nfe_AC, nfe_AN, nfe_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
View(variants.df)
=233+237
233+237
470+197
