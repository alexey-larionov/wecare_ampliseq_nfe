Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_eigenvectors_and_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_check_BRCA1_BRCA2_PALB2"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_eigenvectors_and_outliers"
rm(source_folder)
hist(variants.df$init_AF)
hist(variants.df$init_AF, lab=T)
hist(variants.df$init_AF, lab=T, ylim=c(0,2000))
hist(variants.df$kgen.AF, lab=T, ylim=c(0,2000))
hist(variants.df$kgen.AF, lab=T, ylim=c(0,1000))
hist(variants.df$kgen.AF, lab=T, ylim=c(0,1200))
plot(kgen.AF~init_AF, data=variants.df)
plot(kgen.AF~init_AF, data=variants.df,
main="AF observed in the dataset vs AF observed in kgen")
abline(1,col="red")
?abline
abline(0,1,col="red")
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_eigenvectors_and_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_check_BRCA1_BRCA2_PALB2"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_eigenvectors_and_outliers"
rm(source_folder)
# Chunk 4: start_check
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5
hist(variants.df$init_AF, lab=T, ylim=c(0,2000))
hist(variants.df$kgen.AF, lab=T, ylim=c(0,1200))
plot(kgen.AF~init_AF, data=variants.df,
main="AF observed in the dataset vs AF observed in kgen")
abline(0,1,col="red")
# Chunk 6
colnames(variants.df)
data_for_vcf.df <- data.frame(
variants.df[,c("CHROM","POS","REF","ALT","QUAL")],
ID=".", FILTER="PASS",
INFO=paste("SplitVarID",variants.df$SplitVarID,sep="="))
data_for_vcf.df <- data_for_vcf.df[,c("CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO")]
"#CHROM" -> colnames(data_for_vcf.df)[1]
data_for_vcf.df[1:5,]
file_name <- paste(base_folder, "s01_ampliseq_nfe_1850_vars.txt", sep="/")
write.table(data_for_vcf.df, file=file_name,
quote = F, sep = "\t", row.names=F, col.names=T)
dim(genotypes.mx)
dim(phenotypes.mx)
dim(phenotypes.df)
View(phenotypes.df)
colnames(phenotypes.df)
?write.table
