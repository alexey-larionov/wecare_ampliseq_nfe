Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_check_BRCA1_BRCA2_PALB2"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s10_remove_duplicates"
load(paste(source_folder, "s02_remove_duplicates.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_check_BRCA1_BRCA2_PALB2"
rm(source_folder)
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
BRCA_PALB_carriers <- c("48_S416_L008","137_S323_L008","140_S394_L008")
selected_cases <- ! colnames(genotypes.mx) %in% BRCA_PALB_carriers
genotypes.mx <- genotypes.mx[,selected_cases]
phenotypes.df <- phenotypes.df[selected_cases,]
rm(selected_cases, BRCA_PALB_carriers)
# Function to detect uniform numeric vectors
uniform.udf <- function(x){min(x,na.rm=T) == max(x,na.rm=T)}
# Make the filter
uniform_vars <- apply(genotypes.mx,1,uniform.udf)
sum(uniform_vars)
# Apply filter
variants.df <- variants.df[!uniform_vars,]
genotypes.mx <- genotypes.mx[!uniform_vars,]
# Clean-up
rm(uniform.udf, uniform_vars)
table(phenotypes.df$cc)
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_eigenvectors_and_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_check_BRCA1_BRCA2_PALB2"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_eigenvectors_and_outliers"
rm(source_folder)
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
colnames(variants.df)
data_for_vcf.df <- variants.df[,c("CHROM","POS","REF","ALT")]
data_for_vcf.df <- data.frame(
variants.df[,c("CHROM","POS","REF","ALT","QUAL")],
ID=".", FILTER="PASS",
INFO=paste(SplitVarID,variants.df$variants.df,sep="="))
data_for_vcf.df <- data.frame(
variants.df[,c("CHROM","POS","REF","ALT","QUAL")],
ID=".", FILTER="PASS",
INFO=paste("SplitVarID",variants.df$SplitVarID,sep="="))
View(data_for_vcf.df)
data_for_vcf.df <- data_for_vcf.df[,c("CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO")]
View(data_for_vcf.df)
"#CHROM" -> colnames(data_for_vcf.df)[1]
data_for_vcf.df[1:5,]
file_name <- paste(base_folder, "wecare_nfe_1850_vars.txt", sep="/"))
file_name <- paste(base_folder, "wecare_nfe_1850_vars.txt", sep="/")
?write.table
data_for_vcf.df[1:5,]
file_name <- paste(base_folder, "wecare_nfe_1850_vars.txt", sep="/")
write.table(data_for_vcf.df, file=file_name,
quote = F, sep = "\t", row.names=F, colnames=T)
write.table(data_for_vcf.df, file=file_name,
quote = F, sep = "\t", row.names=F, col.names=T)
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s11_remove_BRCA_PALB_carriers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s10_remove_duplicates"
load(paste(source_folder, "s02_remove_duplicates.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s11_remove_BRCA_PALB_carriers"
rm(source_folder)
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
BRCA_PALB_carriers <- c("48_S416_L008","137_S323_L008","140_S394_L008",
"311_S137_L007", "317_S174_L007", "377_S279_L008")
selected_cases <- ! colnames(genotypes.mx) %in% BRCA_PALB_carriers
genotypes.mx <- genotypes.mx[,selected_cases]
phenotypes.df <- phenotypes.df[selected_cases,]
rm(selected_cases, BRCA_PALB_carriers)
# Function to detect uniform numeric vectors
uniform.udf <- function(x){
if(all(is.na(x))) TRUE
min(x,na.rm=T) == max(x,na.rm=T)}
# Make the filter
uniform_vars <- apply(genotypes.mx,1,uniform.udf)
sum(uniform_vars)
# Function to detect uniform numeric vectors
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
# Make the filter
uniform_vars <- apply(genotypes.mx,1,uniform.udf)
sum(uniform_vars)
# Apply filter
variants.df <- variants.df[!uniform_vars,]
genotypes.mx <- genotypes.mx[!uniform_vars,]
# Clean-up
rm(uniform.udf, uniform_vars)
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
table(phenotypes.df$cc)
258+257
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_joined_PCA"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s11_remove_BRCA_PALB_carriers"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_joined_PCA"
rm(source_folder)
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
hist(variants.df$init_AF, lab=T, ylim=c(0,2000))
hist(variants.df$kgen.AF, lab=T, ylim=c(0,1200))
plot(kgen.AF~init_AF, data=variants.df,
main="AF observed in the dataset vs AF observed in kgen")
abline(0,1,col="red")
colnames(variants.df)
data_for_vcf.df <- data.frame(
variants.df[,c("CHROM","POS","REF","ALT","QUAL")],
ID=".", FILTER="PASS",
INFO=paste("SplitVarID",variants.df$SplitVarID,sep="="))
data_for_vcf.df <- data_for_vcf.df[,c("CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO")]
"#CHROM" -> colnames(data_for_vcf.df)[1]
data_for_vcf.df[1:5,]
file_name <- paste(base_folder, "s01_ampliseq_nfe_1865_vars.txt", sep="/")
write.table(data_for_vcf.df, file=file_name,
quote = F, sep = "\t", row.names=F, col.names=T)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_joined_PCA/s01_prepare_data_for_joined_PCA"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s11_remove_BRCA_PALB_carriers"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_joined_PCA/s01_prepare_data_for_joined_PCA"
rm(source_folder)
# Chunk 4: start_check
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5: explore_AFs
hist(variants.df$init_AF, lab=T, ylim=c(0,2000))
hist(variants.df$kgen.AF, lab=T, ylim=c(0,1200))
plot(kgen.AF~init_AF, data=variants.df,
main="AF observed in the dataset vs AF observed in kgen")
abline(0,1,col="red")
colnames(variants.df)
data_for_vcf.df <- data.frame(
variants.df[,c("CHROM","POS","REF","ALT","QUAL")],
ID=".", FILTER="PASS",
INFO=paste("SplitVarID",variants.df$SplitVarID,sep="="))
data_for_vcf.df <- data_for_vcf.df[,c("CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO")]
"#CHROM" -> colnames(data_for_vcf.df)[1]
data_for_vcf.df[1:5,]
file_name <- paste(base_folder,"data","s01_ampliseq_nfe_1865_vars.txt", sep="/")
write.table(data_for_vcf.df, file=file_name,
quote = F, sep = "\t", row.names=F, col.names=T)
dim(genotypes.mx)
dim(phenotypes.df)
