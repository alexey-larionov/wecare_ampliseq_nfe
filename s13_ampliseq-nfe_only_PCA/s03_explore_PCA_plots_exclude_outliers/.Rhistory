#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s01_add_PCs.RData", sep="/"))
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s12_joined_ampliseq-nfe_1kgp_PCA/s06_explore_joined_PCA_plots"
load(paste(source_folder, "s01_joined_PCA_plots_293_3216_not_rare_not_in_LD.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
# Clean-up
rm(source_folder, eigenphen_nfe_kgen.df)
# Chunk 4: start_check
# List of objects
ls()
# Expected number of samples in eigenvectors
2504+515
dim(eigenphen_ampliseq_kgen.df)
# Dimentions of objects
dim(genotypes.mx)
dim(variants.df)
dim(phenotypes.df)
# Chunk 5: add_outliers
# Get IDs of the ampliseq-nfe-only outliers
ampliseq_nfe_outliers <- phenotypes.df[phenotypes.df$pc_outlier,"long_ids"]
length(ampliseq_nfe_outliers)
# All ampliseq outliers are within the ethnic outliers detected in joined PCA
sum(ampliseq_nfe_outliers %in% joined_outliers)
# Add the column to data frame (for plotting)
ampliseq_nfe_only_outliers <- eigenphen_ampliseq_kgen.df$sample %in% ampliseq_nfe_outliers
eigenphen_ampliseq_kgen.df <- data.frame(eigenphen_ampliseq_kgen.df,ampliseq_nfe_only_outliers)
sum(eigenphen_ampliseq_kgen.df$ampliseq_nfe_only_outliers)
# Clean-up
rm(ampliseq_nfe_only_outliers)
# Chunk 6: ampliseq_kgen_plot
table(eigenphen_ampliseq_kgen.df$group)
# Prepare vector fr colour scale
myColours <- c("EUR"="BLUE", "AFR"="YELLOW", "AMR"="GREEN",
"SAS"="GREY", "EAS"="PINK",
"WECARE"="RED")
myColourScale <- scale_colour_manual(values=myColours)
# Static plot
ggplot(eigenphen_ampliseq_kgen.df, aes(PC1,PC2)) +
geom_point(aes(col=group, shape=ampliseq_nfe_only_outliers)) +
labs(title="PC1 vs PC2", x="PC1", y="PC2") +
scale_shape_manual(values=c(16,4)) +
geom_vline(xintercept=pc1_th, linetype="dashed", size=0.5) +
geom_hline(yintercept=pc2_th, linetype="dashed", size=0.5) +
myColourScale
# Interactive plot
plotly_group <- factor(eigenphen_ampliseq_kgen.df$group,
levels=c("AFR","AMR","EAS","SAS","EUR","WECARE"))
g <- ggplot(eigenphen_ampliseq_kgen.df, aes(PC1,PC2)) +
geom_point(aes(col=plotly_group, shape=ampliseq_nfe_only_outliers, text=sample)) +
labs(title="PC1 vs PC2 (manual thresholds)", x="PC1", y="PC2") +
scale_shape_manual(values=c(16,4)) +
geom_vline(xintercept=pc1_th, linetype="dashed", size=0.5) +
geom_hline(yintercept=pc2_th, linetype="dashed", size=0.5) +
myColourScale
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
# Clean-up
rm(myColours, myColourScale, plotly_group, g)
joined_pca_outlier <- phenotypes.df$long_ids %in% joined_outliers
phenotypes.df <- data.frame(phenotypes.df, joined_pca_outlier)
rm(eigenphen_ampliseq_kgen.df, ampliseq_nfe_outliers,
joined_outliers, joined_pca_outlier, pc1_th, pc2_th)
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Load dataset with manually selected 46 outliers (considering co-clustering with 1KG populations)
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != phenotypes.df$long_ids)
rownames(phenotypes.df) <- phenotypes.df$long_ids
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
variants.df[1:5,1:5]
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
load(paste(base_folder, "s01_add_PCs.RData", sep="/"))
phenotypes.df[1:5,1:5]
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Sequencing data (for wecare phenotypes: case/control status)
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s11_remove_BRCA_PALB_carriers"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
phenotypes.df[1:5,1:5]
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Threshold for outlier detection
th <- 3 # mean +/- (th*sd)
# Sequencing data (for wecare phenotypes: case/control status)
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s11_remove_BRCA_PALB_carriers"
load(paste(source_folder, "s03_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
# Eigenvectors & eigenvalues
source_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s02_calculate_ampliseq_nfe_only_PCs/data/s04_pca"
eigenvectors_file <- paste(source_folder, "ampliseq_nfe_215_712_100PCs.eigenvec", sep="/")
eigenvalues_file <- paste(source_folder, "ampliseq_nfe_215_712_100PCs.eigenval", sep="/")
eigenvectors.df <- read.table(eigenvectors_file, header=T, sep="\t",quote="")
eigenvalues.df <- read.table(eigenvalues_file, header=F, sep="\t",quote="")
# Clean-up
rm(source_folder, eigenvectors_file, eigenvalues_file)
# Chunk 4: start_check
# List of objects
ls()
# Dimentions of objects
dim(eigenvectors.df)
dim(eigenvalues.df)
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
# Counts of nfe/controls/cases
table(phenotypes.df$cc)
# Update eigenvectors
rownames(eigenvectors.df) <- eigenvectors.df$FID
eigenvectors.df <- eigenvectors.df[,-1]
"long_ids" -> colnames(eigenvectors.df)[1]
eigenvectors.df[1:5,1:5]
# Chunk 5: eigenvalues
plot(eigenvalues.df$V1, type="b",
xlab="Eigenvector", ylab="Eigenvalue",
ylim=c(0,20),main="Top 100 eigenvectors")
plot(eigenvalues.df$V1[1:20], type="b",
xlab="Eigenvector", ylab="Eigenvalue",
ylim=c(0,20), main="Top 20 eigenvectors")
rm(eigenvalues.df)
# Add factor column with verbal lables for phenotypes to be used in plot
group <- factor(phenotypes.df$cc, levels = c(0,1,-1), labels = c("UBC","CBC","NFE"))
phenotypes.df <- data.frame(phenotypes.df,group)
table(phenotypes.df$group)
# Add column with sample IDs for the plot
sample_id <- phenotypes.df$Sample_num
sample_id[phenotypes.df$group=="NFE"] <- phenotypes.df$long_ids[phenotypes.df$group=="NFE"]
phenotypes.df <- data.frame(phenotypes.df,sample_id)
head(phenotypes.df$sample_id)
tail(phenotypes.df$sample_id)
phenotypes.df[1:5,1:5]
# Add 5 top eigenvectors to phenotypes
phenotypes.df <- full_join(phenotypes.df,eigenvectors.df[,1:6], by="long_ids")
phenotypes.df[1:5,1:5]
rownames(phenotypes.df) <- phenotypes.df$long_ids
phenotypes.df[1:5,1:5]
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
genotypes.mx[1:5,1:5]
phenotypes.df[1:5,1:5]
variants.df[1:5,1:5]
sum(colnames(genotypes.mx) != phenotypes.df$long_ids)
sum(rownames(genotypes.mx) != rownames(variants.df))
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
712-664
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[;1:26]
phenotypes.df <- phenotypes.df[,1:26]
# Remove unnecessary columns
colnames(phenotypes.df)
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,1:31]
colnames(phenotypes.df)
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
dim(genotypes.mx)
dim(phenotypes.df)
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5: remove_outliers
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,1:31]
colnames(phenotypes.df)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
# Function to detect uniform vectors (expects vectors containing 0,1,2 or NA only)
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
genotypes.mx <- genotypes.mx[!uniform_variants,]
variants.df <- variants.df[!uniform_variants,]
dim(genotypes.mx)
dim(variants.df)
rm(uniform_variants, uniform.udf)
an.udf <- function(x){2*sum(!is.na(x))}
summary(as.factor(phenotypes.df$group))
232+235
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5: remove_outliers
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,1:31]
colnames(phenotypes.df)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
# Chunk 6
# Function to detect uniform vectors (expects vectors containing 0,1,2 or NA only)
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
genotypes.mx <- genotypes.mx[!uniform_variants,]
variants.df <- variants.df[!uniform_variants,]
dim(genotypes.mx)
dim(variants.df)
rm(uniform_variants, uniform.udf)
summary(as.factor(phenotypes.df$group))
232+235
467+197
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
an.udf <- function(x){2*sum(!is.na(x))}
summary(as.factor(phenotypes.df$group))
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
hist(total_AF, lab=T, ylim=c(0,1500))
nfe_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="NFE"]
dim(nfe_genotypes.mx)
nfe_AC <- apply(nfe_genotypes.mx, 1, sum, na.rm=T)
nfe_AN <- apply(nfe_genotypes.mx, 1, an.udf)
nfe_AF <- nfe_AC/nfe_AN
hist(nfe_AF, lab=T, ylim=c(0,1500))
rm(nfe_genotypes.mx)
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s13_ampliseq-nfe_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5: remove_outliers
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,1:31]
colnames(phenotypes.df)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
# Chunk 6
# Function to detect uniform vectors (expects vectors containing 0,1,2 or NA only)
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
genotypes.mx <- genotypes.mx[!uniform_variants,]
variants.df <- variants.df[!uniform_variants,]
dim(genotypes.mx)
dim(variants.df)
rm(uniform_variants, uniform.udf)
# Chunk 7: an_and_counts
an.udf <- function(x){2*sum(!is.na(x))}
summary(as.factor(phenotypes.df$group))
# Chunk 8: total_acanaf
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
hist(total_AF, lab=T, ylim=c(0,1500))
# Chunk 9: nfe_acanaf
nfe_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="NFE"]
dim(nfe_genotypes.mx)
nfe_AC <- apply(nfe_genotypes.mx, 1, sum, na.rm=T)
nfe_AN <- apply(nfe_genotypes.mx, 1, an.udf)
nfe_AF <- nfe_AC/nfe_AN
hist(nfe_AF, lab=T, ylim=c(0,1500))
rm(nfe_genotypes.mx)
# Chunk 10: bc_acanaf
bc_genotypes.mx <- genotypes.mx[,phenotypes.df$group!="NFE"]
dim(bc_genotypes.mx)
bc_AC <- apply(bc_genotypes.mx, 1, sum, na.rm=T)
bc_AN <- apply(bc_genotypes.mx, 1, an.udf)
bc_AF <- bc_AC/bc_AN
hist(bc_AF, lab=T, ylim=c(0,1500))
rm(bc_genotypes.mx)
# Chunk 11: ubc_acanaf
ubc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="UBC"]
dim(ubc_genotypes.mx)
ubc_AC <- apply(ubc_genotypes.mx, 1, sum, na.rm=T)
ubc_AN <- apply(ubc_genotypes.mx, 1, an.udf)
ubc_AF <- ubc_AC/ubc_AN
hist(ubc_AF, lab=T, ylim=c(0,1500))
rm(ubc_genotypes.mx)
# Chunk 12: cbc_acanaf
cbc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="CBC"]
dim(cbc_genotypes.mx)
cbc_AC <- apply(cbc_genotypes.mx, 1, sum, na.rm=T)
cbc_AN <- apply(cbc_genotypes.mx, 1, an.udf)
cbc_AF <- cbc_AC/cbc_AN
hist(cbc_AF, lab=T, ylim=c(0,1500))
rm(cbc_genotypes.mx, an.udf)
variants.df <- data.frame(variants.df,
total_AC, total_AN, total_AF,
bc_AC, bc_AN, bc_AF,
nfe_AC, nfe_AN, nfe_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
rm(total_AC, total_AN, total_AF,
bc_AC, bc_AN, bc_AF,
nfe_AC, nfe_AN, nfe_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
colnames(variants.df)
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
